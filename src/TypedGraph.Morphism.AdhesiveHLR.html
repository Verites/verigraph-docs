<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TypedGraph</span><span class="hs-operator">.</span><span class="hs-identifier">Morphism</span><span class="hs-operator">.</span><span class="hs-identifier">AdhesiveHLR</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span>           </span><a href="Abstract.Morphism.html"><span class="hs-identifier">Abstract</span><span class="hs-operator">.</span><span class="hs-identifier">Morphism</span></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span>           </span><a href="Abstract.AdhesiveHLR.html"><span class="hs-identifier">Abstract</span><span class="hs-operator">.</span><span class="hs-identifier">AdhesiveHLR</span></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span>           </span><a href="Graph.Graph.html"><span class="hs-identifier">Graph</span><span class="hs-operator">.</span><span class="hs-identifier">Graph</span></a><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">G</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Graph.GraphMorphism.html"><span class="hs-identifier">Graph</span><span class="hs-operator">.</span><span class="hs-identifier">GraphMorphism</span></a><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GM</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span>           </span><a href="TypedGraph.Graph.html"><span class="hs-identifier">TypedGraph</span><span class="hs-operator">.</span><span class="hs-identifier">Graph</span></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span>           </span><a href="TypedGraph.Morphism.Core.html"><span class="hs-identifier">TypedGraph</span><span class="hs-operator">.</span><span class="hs-identifier">Morphism</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span></a><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>                                       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">instance</span><span> </span><a href="Abstract.AdhesiveHLR.html#AdhesiveHLR"><span class="hs-identifier hs-type">AdhesiveHLR</span></a><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478103"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478104"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-comment">{-
          g
      A&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9654;C
      &#9474;       &#9474;
     f&#9474;   =   &#9474;g'
      &#9660;       &#9660;
      B&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9654;D
          g'

     PO algorithm:
     1. invert r
     2. compose k and r^-1
     3. create node table  (C -&gt; D)
     5. create edge table  (C -&gt; D)
     4. associate nodes
     6. associate edges
  -}</span><span>
</span><a name="line-34"></a><span>  </span><a name="local-1912678614"><a href="Abstract.AdhesiveHLR.html#calculatePushout"><span class="hs-identifier">calculatePushout</span></a></a><span> </span><a name="local-1627478105"><a href="#local-1627478105"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627478106"><a href="#local-1627478106"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-36"></a><span>        </span><a name="local-1627478107"><a href="#local-1627478107"><span class="hs-identifier">gf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Abstract.Morphism.html#compose"><span class="hs-identifier hs-var">compose</span></a><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#invert"><span class="hs-identifier hs-var">invert</span></a><span> </span><a href="#local-1627478106"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627478105"><span class="hs-identifier hs-var">f</span></a><span>                                 </span><span class="hs-comment">-- invert g and compose with f, obtain gf : C -&gt; B</span><span>
</span><a name="line-37"></a><span>        </span><a name="local-1627478108"><a href="#local-1627478108"><span class="hs-identifier">cOnlyNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#orphanTypedNodes"><span class="hs-identifier hs-var">orphanTypedNodes</span></a><span> </span><a href="#local-1627478106"><span class="hs-identifier hs-var">g</span></a><span>                           </span><span class="hs-comment">-- nodes in C that are not mapped from g</span><span>
</span><a name="line-38"></a><span>        </span><a name="local-1627478109"><a href="#local-1627478109"><span class="hs-identifier">cOnlyEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#orphanTypedEdges"><span class="hs-identifier hs-var">orphanTypedEdges</span></a><span> </span><a href="#local-1627478106"><span class="hs-identifier hs-var">g</span></a><span>                           </span><span class="hs-comment">-- edges in C that are not mapped from g</span><span>
</span><a name="line-39"></a><span>        </span><a name="local-1627478110"><a href="#local-1627478110"><span class="hs-identifier">nodesInF'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-1627478108"><span class="hs-identifier hs-var">cOnlyNodes</span></a><span> </span><span class="hs-special">(</span><a href="TypedGraph.Graph.html#newTypedNodes"><span class="hs-identifier hs-var">newTypedNodes</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Abstract.Morphism.html#codomain"><span class="hs-identifier hs-var">codomain</span></a><span> </span><a href="#local-1627478107"><span class="hs-identifier hs-var">gf</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- table mapping NodeIds in C to NodeIds in D</span><span>
</span><a name="line-40"></a><span>        </span><a name="local-1627478111"><a href="#local-1627478111"><span class="hs-identifier">edgesInF'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-1627478109"><span class="hs-identifier hs-var">cOnlyEdges</span></a><span> </span><span class="hs-special">(</span><a href="TypedGraph.Graph.html#newTypedEdges"><span class="hs-identifier hs-var">newTypedEdges</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Abstract.Morphism.html#codomain"><span class="hs-identifier hs-var">codomain</span></a><span> </span><a href="#local-1627478107"><span class="hs-identifier hs-var">gf</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- table mapping EdgeIds in C to EdgeIds in D</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>        </span><span class="hs-comment">-- generate new node instances in D, associating them to the &quot;created&quot; nodes in C</span><span>
</span><a name="line-43"></a><span>        </span><a name="local-1627478112"><a href="#local-1627478112"><span class="hs-identifier">gf'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.AdhesiveHLR.html#generateNewNodeInstances"><span class="hs-identifier hs-var">generateNewNodeInstances</span></a><span> </span><a href="#local-1627478107"><span class="hs-identifier hs-var">gf</span></a><span> </span><a href="#local-1627478110"><span class="hs-identifier hs-var">nodesInF'</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>        </span><span class="hs-comment">-- query the instance graphs C</span><span>
</span><a name="line-46"></a><span>        </span><a name="local-1627478113"><a href="#local-1627478113"><span class="hs-identifier">typemor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Abstract.Morphism.html#domain"><span class="hs-identifier hs-var">domain</span></a><span>         </span><a href="#local-1627478112"><span class="hs-identifier hs-var">gf'</span></a><span>                     </span><span class="hs-comment">-- typemor is the typed graph (C -&gt; T)</span><span>
</span><a name="line-47"></a><span>        </span><a name="local-1627478114"><a href="#local-1627478114"><span class="hs-identifier">d</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Abstract.Morphism.html#domain"><span class="hs-identifier hs-var">domain</span></a><span>         </span><a href="#local-1627478113"><span class="hs-identifier hs-var">typemor</span></a><span>                 </span><span class="hs-comment">-- d  is the instance graph C</span><span>
</span><a name="line-48"></a><span>        </span><a name="local-1627478115"><a href="#local-1627478115"><span class="hs-identifier">mp</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mapping</span><span>        </span><a href="#local-1627478112"><span class="hs-identifier hs-var">gf'</span></a><span>                     </span><span class="hs-comment">-- mp is the mapping of gf'  : (C -&gt; B'), where B' = B + new nodes</span><span>
</span><a name="line-49"></a><span>        </span><a name="local-1627478116"><a href="#local-1627478116"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-1627478123"><a href="#local-1627478123"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.Graph.html#sourceOf"><span class="hs-identifier hs-var">G</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sourceOf</span></a><span> </span><a href="#local-1627478114"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-1627478123"><span class="hs-identifier hs-var">e</span></a><span>                 </span><span class="hs-comment">-- obtain source of e in C</span><span>
</span><a name="line-50"></a><span>        </span><a name="local-1627478117"><a href="#local-1627478117"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627478124"><a href="#local-1627478124"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.Graph.html#targetOf"><span class="hs-identifier hs-var">G</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">targetOf</span></a><span> </span><a href="#local-1627478114"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-1627478124"><span class="hs-identifier hs-var">e</span></a><span>                 </span><span class="hs-comment">-- obtain target of e in C</span><span>
</span><a name="line-51"></a><span>        </span><a name="local-1627478118"><a href="#local-1627478118"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-1627478125"><a href="#local-1627478125"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.GraphMorphism.html#applyNode"><span class="hs-identifier hs-var">GM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">applyNode</span></a><span> </span><a href="#local-1627478115"><span class="hs-identifier hs-var">mp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627478116"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1627478125"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- obtain source of m'(e) in D</span><span>
</span><a name="line-52"></a><span>        </span><a name="local-1627478119"><a href="#local-1627478119"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-1627478126"><a href="#local-1627478126"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.GraphMorphism.html#applyNode"><span class="hs-identifier hs-var">GM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">applyNode</span></a><span> </span><a href="#local-1627478115"><span class="hs-identifier hs-var">mp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627478117"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627478126"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- obtain target of m'(e) in D</span><span>
</span><a name="line-53"></a><span>        </span><a name="local-1627478120"><a href="#local-1627478120"><span class="hs-identifier">tp</span></a></a><span> </span><a name="local-1627478127"><a href="#local-1627478127"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.GraphMorphism.html#applyEdge"><span class="hs-identifier hs-var">GM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">applyEdge</span></a><span> </span><a href="#local-1627478113"><span class="hs-identifier hs-var">typemor</span></a><span> </span><a href="#local-1627478127"><span class="hs-identifier hs-var">e</span></a><span>         </span><span class="hs-comment">-- obtain type of e in C</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>        </span><span class="hs-comment">-- generate new edge table with new information</span><span>
</span><a name="line-56"></a><span>        </span><a name="local-1627478121"><a href="#local-1627478121"><span class="hs-identifier">edgeTable'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627478128"><a href="#local-1627478128"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><a name="local-1627478129"><a href="#local-1627478129"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627478128"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478116"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1627478128"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478117"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627478128"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478129"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478118"><span class="hs-identifier hs-var">s2</span></a><span> </span><a href="#local-1627478128"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478119"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-1627478128"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478120"><span class="hs-identifier hs-var">tp</span></a><span> </span><a href="#local-1627478128"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627478111"><span class="hs-identifier hs-var">edgesInF'</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><span class="hs-comment">-- create new morphism adding all edges</span><span>
</span><a name="line-59"></a><span>        </span><a name="local-1627478122"><a href="#local-1627478122"><span class="hs-identifier">kr''</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.AdhesiveHLR.html#generateNewEdgeInstances"><span class="hs-identifier hs-var">generateNewEdgeInstances</span></a><span> </span><a href="#local-1627478112"><span class="hs-identifier hs-var">gf'</span></a><span> </span><a href="#local-1627478121"><span class="hs-identifier hs-var">edgeTable'</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627478122"><span class="hs-identifier hs-var">kr''</span></a><span class="hs-special">,</span><span> </span><a href="TypedGraph.Morphism.Core.html#idMap"><span class="hs-identifier hs-var">idMap</span></a><span> </span><span class="hs-special">(</span><a href="Abstract.Morphism.html#codomain"><span class="hs-identifier hs-var">codomain</span></a><span> </span><a href="#local-1627478105"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Abstract.Morphism.html#codomain"><span class="hs-identifier hs-var">codomain</span></a><span> </span><a href="#local-1627478122"><span class="hs-identifier hs-var">kr''</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-comment">{-
     PO complement algorithm:
     1. compose l and m generating ml
     2. query edges for deletion in the codomain of ml
     2. query nodes for deletion in the codomain of ml
     3. delete all edges
     4. delete all nodes
  -}</span><span>
</span><a name="line-71"></a><span>  </span><a name="local-1912678616"><a href="Abstract.AdhesiveHLR.html#calculatePushoutComplement"><span class="hs-identifier">calculatePushoutComplement</span></a></a><span> </span><a name="local-1627478130"><a href="#local-1627478130"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627478131"><a href="#local-1627478131"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1627478132"><a href="#local-1627478132"><span class="hs-identifier">ml</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Abstract.Morphism.html#compose"><span class="hs-identifier hs-var">compose</span></a><span> </span><a href="#local-1627478131"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627478130"><span class="hs-identifier hs-var">m</span></a><span>                                                         </span><span class="hs-comment">-- compose l and m obtaining ml</span><span>
</span><a name="line-73"></a><span>        </span><a name="local-1627478133"><a href="#local-1627478133"><span class="hs-identifier">delEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><span class="hs-special">(</span><a href="Graph.GraphMorphism.html#applyEdge"><span class="hs-identifier hs-var">GM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">applyEdge</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mapping</span><span> </span><a href="#local-1627478130"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#orphanTypedEdges"><span class="hs-identifier hs-var">orphanTypedEdges</span></a><span> </span><a href="#local-1627478131"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- obtain list of edges to be deleted in G</span><span>
</span><a name="line-74"></a><span>        </span><a name="local-1627478134"><a href="#local-1627478134"><span class="hs-identifier">delNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><span class="hs-special">(</span><a href="Graph.GraphMorphism.html#applyNode"><span class="hs-identifier hs-var">GM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">applyNode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mapping</span><span> </span><a href="#local-1627478130"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#orphanTypedNodes"><span class="hs-identifier hs-var">orphanTypedNodes</span></a><span> </span><a href="#local-1627478131"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- obtain list of nodes to be deleted in G</span><span>
</span><a name="line-75"></a><span>        </span><a name="local-1627478135"><a href="#local-1627478135"><span class="hs-identifier">k</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="TypedGraph.Morphism.Core.html#removeNodeFromCodomain"><span class="hs-identifier hs-var">removeNodeFromCodomain</span></a><span>                                          </span><span class="hs-comment">-- delete all edges, then all nodes from ml</span><span>
</span><a name="line-76"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="TypedGraph.Morphism.Core.html#removeEdgeFromCodomain"><span class="hs-identifier hs-var">removeEdgeFromCodomain</span></a><span> </span><a href="#local-1627478132"><span class="hs-identifier hs-var">ml</span></a><span> </span><a href="#local-1627478133"><span class="hs-identifier hs-var">delEdges</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>                           </span><a href="#local-1627478134"><span class="hs-identifier hs-var">delNodes</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627478135"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="TypedGraph.Morphism.Core.html#idMap"><span class="hs-identifier hs-var">idMap</span></a><span> </span><span class="hs-special">(</span><a href="Abstract.Morphism.html#codomain"><span class="hs-identifier hs-var">codomain</span></a><span> </span><a href="#local-1627478135"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Abstract.Morphism.html#codomain"><span class="hs-identifier hs-var">codomain</span></a><span> </span><a href="#local-1627478130"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>  </span><a name="local-1912678617"><a href="Abstract.AdhesiveHLR.html#monomorphicPullback"><span class="hs-identifier">monomorphicPullback</span></a></a><span> </span><a name="local-1627478136"><a href="#local-1627478136"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627478137"><a href="#local-1627478137"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627478147"><span class="hs-identifier hs-var">delNodesFromF'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478149"><span class="hs-identifier hs-var">delNodesFromG'</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-83"></a><span>      </span><a name="local-1627478138"><a href="#local-1627478138"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#invert"><span class="hs-identifier hs-var">invert</span></a><span> </span><a href="#local-1627478136"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-84"></a><span>      </span><a name="local-1627478139"><a href="#local-1627478139"><span class="hs-identifier">g'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#invert"><span class="hs-identifier hs-var">invert</span></a><span> </span><a href="#local-1627478137"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-85"></a><span>      </span><a name="local-1627478140"><a href="#local-1627478140"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#nodesFromDomain"><span class="hs-identifier hs-var">nodesFromDomain</span></a><span> </span><a href="#local-1627478138"><span class="hs-identifier hs-var">f'</span></a><span>
</span><a name="line-86"></a><span>      </span><a name="local-1627478141"><a href="#local-1627478141"><span class="hs-identifier">edges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#edgesFromDomain"><span class="hs-identifier hs-var">edgesFromDomain</span></a><span> </span><a href="#local-1627478138"><span class="hs-identifier hs-var">f'</span></a><span>
</span><a name="line-87"></a><span>      </span><a name="local-1627478142"><a href="#local-1627478142"><span class="hs-identifier">knodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627478150"><a href="#local-1627478150"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#applyNode"><span class="hs-identifier hs-var">applyNode</span></a><span> </span><a href="#local-1627478138"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-1627478150"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#applyNode"><span class="hs-identifier hs-var">applyNode</span></a><span> </span><a href="#local-1627478139"><span class="hs-identifier hs-var">g'</span></a><span> </span><a href="#local-1627478150"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627478140"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-88"></a><span>      </span><a name="local-1627478143"><a href="#local-1627478143"><span class="hs-identifier">kedges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627478151"><a href="#local-1627478151"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#applyEdge"><span class="hs-identifier hs-var">applyEdge</span></a><span> </span><a href="#local-1627478138"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-1627478151"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#applyEdge"><span class="hs-identifier hs-var">applyEdge</span></a><span> </span><a href="#local-1627478139"><span class="hs-identifier hs-var">g'</span></a><span> </span><a href="#local-1627478151"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627478141"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-89"></a><span>      </span><a name="local-1627478144"><a href="#local-1627478144"><span class="hs-identifier">delNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627478140"><span class="hs-identifier hs-var">nodes</span></a><span> </span><span class="hs-operator hs-var">\\</span><span> </span><a href="#local-1627478142"><span class="hs-identifier hs-var">knodes</span></a><span>
</span><a name="line-90"></a><span>      </span><a name="local-1627478145"><a href="#local-1627478145"><span class="hs-identifier">delEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627478141"><span class="hs-identifier hs-var">edges</span></a><span> </span><span class="hs-operator hs-var">\\</span><span> </span><a href="#local-1627478143"><span class="hs-identifier hs-var">kedges</span></a><span>
</span><a name="line-91"></a><span>      </span><a name="local-1627478146"><a href="#local-1627478146"><span class="hs-identifier">delEdgesFromF'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="TypedGraph.Morphism.Core.html#removeEdgeFromDomain"><span class="hs-identifier hs-var">removeEdgeFromDomain</span></a><span> </span><a href="#local-1627478138"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-1627478145"><span class="hs-identifier hs-var">delEdges</span></a><span>
</span><a name="line-92"></a><span>      </span><a name="local-1627478147"><a href="#local-1627478147"><span class="hs-identifier">delNodesFromF'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="TypedGraph.Morphism.Core.html#removeNodeFromDomain"><span class="hs-identifier hs-var">removeNodeFromDomain</span></a><span> </span><a href="#local-1627478146"><span class="hs-identifier hs-var">delEdgesFromF'</span></a><span> </span><a href="#local-1627478144"><span class="hs-identifier hs-var">delNodes</span></a><span>
</span><a name="line-93"></a><span>      </span><a name="local-1627478148"><a href="#local-1627478148"><span class="hs-identifier">delEdgesFromG'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="TypedGraph.Morphism.Core.html#removeEdgeFromDomain"><span class="hs-identifier hs-var">removeEdgeFromDomain</span></a><span> </span><a href="#local-1627478139"><span class="hs-identifier hs-var">g'</span></a><span> </span><a href="#local-1627478145"><span class="hs-identifier hs-var">delEdges</span></a><span>
</span><a name="line-94"></a><span>      </span><a name="local-1627478149"><a href="#local-1627478149"><span class="hs-identifier">delNodesFromG'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="TypedGraph.Morphism.Core.html#removeNodeFromDomain"><span class="hs-identifier hs-var">removeNodeFromDomain</span></a><span> </span><a href="#local-1627478148"><span class="hs-identifier hs-var">delEdgesFromG'</span></a><span> </span><a href="#local-1627478144"><span class="hs-identifier hs-var">delNodes</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>  </span><a name="local-1912678615"><a href="Abstract.AdhesiveHLR.html#hasPushoutComplement"><span class="hs-identifier">hasPushoutComplement</span></a></a><span> </span><span class="hs-special">(</span><a href="Abstract.Morphism.html#Monomorphism"><span class="hs-identifier hs-var">Monomorphism</span></a><span class="hs-special">,</span><span> </span><a name="local-1627478152"><a href="#local-1627478152"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627478153"><a href="#local-1627478153"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-98"></a><span>    </span><a href="TypedGraph.Morphism.AdhesiveHLR.html#satisfiesDanglingCondition"><span class="hs-identifier hs-var">satisfiesDanglingCondition</span></a><span> </span><a href="#local-1627478153"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627478152"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-identifier">hasPushoutComplement</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627478154"><a href="#local-1627478154"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627478155"><a href="#local-1627478155"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-102"></a><span>    </span><a href="TypedGraph.Morphism.AdhesiveHLR.html#satisfiesDanglingCondition"><span class="hs-identifier hs-var">satisfiesDanglingCondition</span></a><span> </span><a href="#local-1627478155"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627478154"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TypedGraph.Morphism.AdhesiveHLR.html#satisfiesIdentificationCondition"><span class="hs-identifier hs-var">satisfiesIdentificationCondition</span></a><span> </span><a href="#local-1627478155"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627478154"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-identifier">generateNewNodeInstances</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478058"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478059"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478058"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478059"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-106"></a><a name="generateNewNodeInstances"><a href="TypedGraph.Morphism.AdhesiveHLR.html#generateNewNodeInstances"><span class="hs-identifier">generateNewNodeInstances</span></a></a><span> </span><a name="local-1627478060"><a href="#local-1627478060"><span class="hs-identifier">gf</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627478061"><a href="#local-1627478061"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-1627478062"><a href="#local-1627478062"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627478063"><a href="#local-1627478063"><span class="hs-identifier">tgm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627478064"><a href="#local-1627478064"><span class="hs-identifier">tp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.GraphMorphism.html#applyNode"><span class="hs-identifier hs-var">GM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">applyNode</span></a><span> </span><span class="hs-special">(</span><a href="Abstract.Morphism.html#domain"><span class="hs-identifier hs-var">domain</span></a><span> </span><a href="#local-1627478060"><span class="hs-identifier hs-var">gf</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627478061"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-108"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><a href="TypedGraph.Morphism.Core.html#updateNodeRelation"><span class="hs-identifier hs-var">updateNodeRelation</span></a><span> </span><a href="#local-1627478061"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1627478062"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627478064"><span class="hs-identifier hs-var">tp</span></a><span> </span><a href="#local-1627478063"><span class="hs-identifier hs-var">tgm</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627478060"><span class="hs-identifier hs-var">gf</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">generateNewEdgeInstances</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478056"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478057"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478056"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478057"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-113"></a><a name="generateNewEdgeInstances"><a href="TypedGraph.Morphism.AdhesiveHLR.html#generateNewEdgeInstances"><span class="hs-identifier">generateNewEdgeInstances</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627478065"><a href="#local-1627478065"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627478066"><a href="#local-1627478066"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-1627478067"><a href="#local-1627478067"><span class="hs-identifier">sb</span></a></a><span class="hs-special">,</span><a name="local-1627478068"><a href="#local-1627478068"><span class="hs-identifier">tb</span></a></a><span class="hs-special">,</span><a name="local-1627478069"><a href="#local-1627478069"><span class="hs-identifier">tp</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627478070"><a href="#local-1627478070"><span class="hs-identifier">tgm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#updateEdgeRelation"><span class="hs-identifier hs-var">updateEdgeRelation</span></a><span> </span><a href="#local-1627478065"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1627478066"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#createEdgeOnCodomain"><span class="hs-identifier hs-var">createEdgeOnCodomain</span></a><span> </span><a href="#local-1627478066"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627478067"><span class="hs-identifier hs-var">sb</span></a><span> </span><a href="#local-1627478068"><span class="hs-identifier hs-var">tb</span></a><span> </span><a href="#local-1627478069"><span class="hs-identifier hs-var">tp</span></a><span> </span><a href="#local-1627478070"><span class="hs-identifier hs-var">tgm</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">---- Gluing Conditions</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- | Return True if the match @m@ satifies the identification condition for existence of</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- a pushout complement</span><span>
</span><a name="line-122"></a><span class="hs-identifier">satisfiesIdentificationCondition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478054"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478055"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478054"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478055"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-123"></a><a name="satisfiesIdentificationCondition"><a href="TypedGraph.Morphism.AdhesiveHLR.html#satisfiesIdentificationCondition"><span class="hs-identifier">satisfiesIdentificationCondition</span></a></a><span> </span><a name="local-1627478071"><a href="#local-1627478071"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627478072"><a href="#local-1627478072"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627478073"><span class="hs-identifier hs-var">notIdentificatedNodes</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-1627478074"><span class="hs-identifier hs-var">notIdentificatedEdges</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-126"></a><span>    </span><a name="local-1627478073"><a href="#local-1627478073"><span class="hs-identifier">notIdentificatedNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-127"></a><span>      </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.AdhesiveHLR.html#notIdentificatedElement"><span class="hs-identifier hs-var">notIdentificatedElement</span></a><span> </span><a href="#local-1627478071"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627478072"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#nodesFromDomain"><span class="hs-identifier hs-var">nodesFromDomain</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#applyNode"><span class="hs-identifier hs-var">applyNode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#nodesFromCodomain"><span class="hs-identifier hs-var">nodesFromCodomain</span></a><span> </span><a href="#local-1627478072"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-1627478074"><a href="#local-1627478074"><span class="hs-identifier">notIdentificatedEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-129"></a><span>      </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.AdhesiveHLR.html#notIdentificatedElement"><span class="hs-identifier hs-var">notIdentificatedElement</span></a><span> </span><a href="#local-1627478071"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627478072"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#edgesFromDomain"><span class="hs-identifier hs-var">edgesFromDomain</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#applyEdge"><span class="hs-identifier hs-var">applyEdge</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#edgesFromCodomain"><span class="hs-identifier hs-var">edgesFromCodomain</span></a><span> </span><a href="#local-1627478072"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Given a left-hand-side morphism /l : K -&gt; L/, a match /m : L -&gt; G/, two functions /domain/ (to get all elements</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- in the domain of m) and /apply/ (for applying an element in a TypedGraphMorphism),</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- and an element __/e/__ (that can be either a __/Node/__ or an __/Edge/__) it returns true if /e/ is</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- identificated (i.e. __e__ has more than one incident element on itself and at least one of them deletes it)</span><span>
</span><a name="line-136"></a><span class="hs-identifier">notIdentificatedElement</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-1627478051"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478052"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478053"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478052"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478053"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478052"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478053"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627478051"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478052"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478053"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627478051"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627478051"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627478051"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-138"></a><a name="notIdentificatedElement"><a href="TypedGraph.Morphism.AdhesiveHLR.html#notIdentificatedElement"><span class="hs-identifier">notIdentificatedElement</span></a></a><span> </span><a name="local-1627478075"><a href="#local-1627478075"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627478076"><a href="#local-1627478076"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627478077"><a href="#local-1627478077"><span class="hs-identifier">domain</span></a></a><span> </span><a name="local-1627478078"><a href="#local-1627478078"><span class="hs-identifier">apply</span></a></a><span> </span><a name="local-1627478079"><a href="#local-1627478079"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-1627478080"><span class="hs-identifier hs-var">incidentElements</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1627478082"><span class="hs-identifier hs-var">eIsDeleted</span></a><span>
</span><a name="line-139"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-140"></a><span>    </span><a name="local-1627478080"><a href="#local-1627478080"><span class="hs-identifier">incidentElements</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1627478083"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1627478083"><a href="#local-1627478083"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627478077"><span class="hs-identifier hs-var">domain</span></a><span> </span><a href="#local-1627478076"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627478078"><span class="hs-identifier hs-var">apply</span></a><span> </span><a href="#local-1627478076"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1627478083"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1627478079"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>    </span><a name="local-1627478081"><a href="#local-1627478081"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627478078"><span class="hs-identifier hs-var">apply</span></a><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#invert"><span class="hs-identifier hs-var">invert</span></a><span> </span><a href="#local-1627478075"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-1627478082"><a href="#local-1627478082"><span class="hs-identifier">eIsDeleted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-1627478081"><span class="hs-identifier hs-var">l'</span></a><span> </span><a href="#local-1627478080"><span class="hs-identifier hs-var">incidentElements</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Given a left-hand-side morphism /l : K -&gt; L/, a match /m : L -&gt; G/, returns @true@ if</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- there aren't dangling edges</span><span>
</span><a name="line-147"></a><span class="hs-identifier">satisfiesDanglingCondition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478049"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478050"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478049"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478050"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-148"></a><a name="satisfiesDanglingCondition"><a href="TypedGraph.Morphism.AdhesiveHLR.html#satisfiesDanglingCondition"><span class="hs-identifier">satisfiesDanglingCondition</span></a></a><span> </span><a name="local-1627478084"><a href="#local-1627478084"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627478085"><a href="#local-1627478085"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-1627478092"><span class="hs-identifier hs-var">incidentDeletedEdges</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>        </span><a name="local-1627478086"><a href="#local-1627478086"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#graphDomain"><span class="hs-identifier hs-var">graphDomain</span></a><span> </span><a href="#local-1627478085"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-151"></a><span>        </span><a name="local-1627478087"><a href="#local-1627478087"><span class="hs-identifier">instanceGraph</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TypedGraph.Morphism.Core.html#graphCodomain"><span class="hs-identifier hs-var">graphCodomain</span></a><span> </span><a href="#local-1627478085"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-152"></a><span>        </span><a name="local-1627478088"><a href="#local-1627478088"><span class="hs-identifier">checkEdgeDeletion</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.AdhesiveHLR.html#checkDeletion"><span class="hs-identifier hs-var">checkDeletion</span></a><span> </span><a href="#local-1627478084"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627478085"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#applyEdge"><span class="hs-identifier hs-var">applyEdge</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#edgesFromDomain"><span class="hs-identifier hs-var">edgesFromDomain</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>        </span><a name="local-1627478089"><a href="#local-1627478089"><span class="hs-identifier">matchedNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#applyNode"><span class="hs-identifier hs-var">applyNode</span></a><span> </span><a href="#local-1627478085"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#nodes"><span class="hs-identifier hs-var">nodes</span></a><span> </span><a href="#local-1627478086"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>        </span><a name="local-1627478090"><a href="#local-1627478090"><span class="hs-identifier">deletedNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.AdhesiveHLR.html#checkDeletion"><span class="hs-identifier hs-var">checkDeletion</span></a><span> </span><a href="#local-1627478084"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627478085"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#applyNode"><span class="hs-identifier hs-var">applyNode</span></a><span> </span><a href="TypedGraph.Morphism.Core.html#nodesFromDomain"><span class="hs-identifier hs-var">nodesFromDomain</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627478089"><span class="hs-identifier hs-var">matchedNodes</span></a><span>
</span><a name="line-155"></a><span>        </span><a name="local-1627478091"><a href="#local-1627478091"><span class="hs-identifier">incidentEdgesOnDeletedNodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a><span> </span><a href="#local-1627478087"><span class="hs-identifier hs-var">instanceGraph</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627478090"><span class="hs-identifier hs-var">deletedNodes</span></a><span>
</span><a name="line-156"></a><span>        </span><a name="local-1627478092"><a href="#local-1627478092"><span class="hs-identifier">incidentDeletedEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-1627478088"><span class="hs-identifier hs-var">checkEdgeDeletion</span></a><span> </span><a href="#local-1627478091"><span class="hs-identifier hs-var">incidentEdgesOnDeletedNodes</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | TODO: Find a better name for this function, that was repeated both here and in the GraphRule archive</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- | Given the left-hand-side morphism of a rule /l : K -&gt; L/, a match /m : L -&gt; G/ for this rule, an element __/e/__</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- (that can be either a __/Node/__ or an __/Edge/__) and two functions /apply/ (for applying that element in a TypedGraphMorphism) and</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- /list/ (to get all the corresponding elements in the domain of m), it returns true if /e/ is deleted by this rule for the given match</span><span>
</span><a name="line-163"></a><span class="hs-identifier">checkDeletion</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-1627478046"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478047"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478048"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478047"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478048"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478047"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478048"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627478046"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627478046"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TypedGraph.Morphism.Core.html#TypedGraphMorphism"><span class="hs-identifier hs-type">TypedGraphMorphism</span></a><span> </span><a href="#local-1627478047"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627478048"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627478046"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627478046"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-165"></a><a name="checkDeletion"><a href="TypedGraph.Morphism.AdhesiveHLR.html#checkDeletion"><span class="hs-identifier">checkDeletion</span></a></a><span> </span><a name="local-1627478093"><a href="#local-1627478093"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627478094"><a href="#local-1627478094"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627478095"><a href="#local-1627478095"><span class="hs-identifier">apply</span></a></a><span> </span><a name="local-1627478096"><a href="#local-1627478096"><span class="hs-identifier">list</span></a></a><span> </span><a name="local-1627478097"><a href="#local-1627478097"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627478098"><span class="hs-identifier hs-var">elementInL</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1627478100"><span class="hs-identifier hs-var">elementInK</span></a><span>
</span><a name="line-166"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>    </span><a name="local-1627478098"><a href="#local-1627478098"><span class="hs-identifier">elementInL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627478101"><a href="#local-1627478101"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627478095"><span class="hs-identifier hs-var">apply</span></a><span> </span><a href="#local-1627478094"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1627478101"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1627478097"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627478096"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-1627478094"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>    </span><a name="local-1627478099"><a href="#local-1627478099"><span class="hs-identifier">kToG</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Abstract.Morphism.html#compose"><span class="hs-identifier hs-var">compose</span></a><span> </span><a href="#local-1627478093"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627478094"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-169"></a><span>    </span><a name="local-1627478100"><a href="#local-1627478100"><span class="hs-identifier">elementInK</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627478102"><a href="#local-1627478102"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627478095"><span class="hs-identifier hs-var">apply</span></a><span> </span><a href="#local-1627478099"><span class="hs-identifier hs-var">kToG</span></a><span> </span><a href="#local-1627478102"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1627478097"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627478096"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-1627478099"><span class="hs-identifier hs-var">kToG</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a></pre></body></html>