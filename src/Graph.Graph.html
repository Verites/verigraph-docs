<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
An implementation of labeled directed graphs, allowing multiple parallel edges.

The implementation is based on using integer identifiers for nodes and edges, and association lists to store additional information such as payloads, sources and targets.

Operation comments contain the operation time complexity in the Big-O notation
&lt;http://en.wikipedia.org/wiki/Big_O_notation&gt;, denoting by /v/ the number of nodes in a graph, and
by /e/ the number of edges in a graph.
-}</span><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graph</span><span class="hs-operator">.</span><span class="hs-identifier">Graph</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-comment">-- * Graph Type</span><span>
</span><a name="line-12"></a><span>      </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-comment">-- * Contexts and Graph Traversal</span><span>
</span><a name="line-19"></a><span>    </span><span class="hs-comment">-- $contexts</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier hs-type">NodeInContext</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeContext"><span class="hs-identifier hs-type">NodeContext</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#incomingEdges"><span class="hs-identifier hs-var">incomingEdges</span></a><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#outgoingEdges"><span class="hs-identifier hs-var">outgoingEdges</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-comment">-- ** Neighbour nodes</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-comment">-- $neighbours</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-comment">-- * Query</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#null"><span class="hs-identifier hs-var">Graph</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Graph</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#isNodeOf"><span class="hs-identifier hs-var">isNodeOf</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#isEdgeOf"><span class="hs-identifier hs-var">isEdgeOf</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#lookupNode"><span class="hs-identifier hs-var">lookupNode</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#lookupNodeInContext"><span class="hs-identifier hs-var">lookupNodeInContext</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#lookupEdge"><span class="hs-identifier hs-var">lookupEdge</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#lookupEdgeInContext"><span class="hs-identifier hs-var">lookupEdgeInContext</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#isAdjacentTo"><span class="hs-identifier hs-var">isAdjacentTo</span></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#isIncidentTo"><span class="hs-identifier hs-var">isIncidentTo</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#nodesOf"><span class="hs-identifier hs-var">nodesOf</span></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#sourceOf"><span class="hs-identifier hs-var">sourceOf</span></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#sourceOfUnsafe"><span class="hs-identifier hs-var">sourceOfUnsafe</span></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#targetOf"><span class="hs-identifier hs-var">targetOf</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#targetOfUnsafe"><span class="hs-identifier hs-var">targetOfUnsafe</span></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#getIncidentEdges"><span class="hs-identifier hs-var">getIncidentEdges</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-comment">-- * Construction</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#build"><span class="hs-identifier hs-var">build</span></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#fromNodesAndEdges"><span class="hs-identifier hs-var">fromNodesAndEdges</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- ** Insertion</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#insertNode"><span class="hs-identifier hs-var">insertNode</span></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#insertNodeWithPayload"><span class="hs-identifier hs-var">insertNodeWithPayload</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#insertEdge"><span class="hs-identifier hs-var">insertEdge</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#insertEdgeWithPayload"><span class="hs-identifier hs-var">insertEdgeWithPayload</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-comment">-- ** Delete</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#removeNode"><span class="hs-identifier hs-var">removeNode</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#removeNodeForced"><span class="hs-identifier hs-var">removeNodeForced</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#removeNodeAndIncidentEdges"><span class="hs-identifier hs-var">removeNodeAndIncidentEdges</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#removeEdge"><span class="hs-identifier hs-var">removeEdge</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- ** Update</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#updateNodePayload"><span class="hs-identifier hs-var">updateNodePayload</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#updateEdgePayload"><span class="hs-identifier hs-var">updateEdgePayload</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-comment">-- * Conversion</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- ** Lists</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#nodes"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#edges"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#nodeIds"><span class="hs-identifier hs-var">nodeIds</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier hs-var">edgeIds</span></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#nodesInContext"><span class="hs-identifier hs-var">nodesInContext</span></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#edgesInContext"><span class="hs-identifier hs-var">edgesInContext</span></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#newNodes"><span class="hs-identifier hs-var">newNodes</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#newEdges"><span class="hs-identifier hs-var">newEdges</span></a><span>
</span><a name="line-79"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span>           </span><a href="Abstract.Cardinality.html"><span class="hs-identifier">Abstract</span><span class="hs-operator">.</span><span class="hs-identifier">Cardinality</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span>           </span><a href="Abstract.Valid.html"><span class="hs-identifier">Abstract</span><span class="hs-operator">.</span><span class="hs-identifier">Valid</span></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Type of node identifiers, which are essentially integers.</span><span>
</span><a name="line-89"></a><span class="hs-keyword">newtype</span><span> </span><a name="NodeId"><a href="Graph.Graph.html#NodeId"><span class="hs-identifier">NodeId</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>  </span><a name="NodeId"><a href="Graph.Graph.html#NodeId"><span class="hs-identifier">NodeId</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- | Type of edge identifiers, which are essentially integers.</span><span>
</span><a name="line-95"></a><span class="hs-keyword">newtype</span><span> </span><a name="EdgeId"><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier">EdgeId</span></a></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EdgeId"><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier">EdgeId</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-101"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076743"><a href="#local-6989586621679076743"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076743"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-105"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076742"><a href="#local-6989586621679076742"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076742"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076732"><a href="#local-6989586621679076732"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-8214565720323790792"><span class="hs-operator">+</span></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076733"><a href="#local-6989586621679076733"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076732"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679076733"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076734"><a href="#local-6989586621679076734"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-8214565720323790791"><span class="hs-operator">*</span></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076735"><a href="#local-6989586621679076735"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076734"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679076735"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076736"><a href="#local-6989586621679076736"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-</span><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076737"><a href="#local-6989586621679076737"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076736"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679076737"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>  </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076738"><a href="#local-6989586621679076738"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679076738"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>  </span><a name="local-8214565720323790789"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076739"><a href="#local-6989586621679076739"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">signum</span><span> </span><a href="#local-6989586621679076739"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><a name="local-6989586621679076740"><a href="#local-6989586621679076740"><span class="hs-identifier">x</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679076740"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-115"></a><span>  </span><a name="local-8214565720323790790"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076741"><a href="#local-6989586621679076741"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076741"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>  </span><a name="local-8214565720323790708"><span class="hs-identifier">toEnum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span>
</span><a name="line-120"></a><span>  </span><a name="local-8214565720323790707"><span class="hs-identifier">fromEnum</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a name="local-6989586621679076731"><a href="#local-6989586621679076731"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076731"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076721"><a href="#local-6989586621679076721"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-8214565720323790792"><span class="hs-operator">+</span></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076722"><a href="#local-6989586621679076722"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076721"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679076722"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076723"><a href="#local-6989586621679076723"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-8214565720323790791"><span class="hs-operator">*</span></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076724"><a href="#local-6989586621679076724"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076723"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679076724"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076725"><a href="#local-6989586621679076725"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-</span><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076726"><a href="#local-6989586621679076726"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076725"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679076726"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>  </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076727"><a href="#local-6989586621679076727"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679076727"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>  </span><a name="local-8214565720323790789"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076728"><a href="#local-6989586621679076728"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">signum</span><span> </span><a href="#local-6989586621679076728"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>  </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><a name="local-6989586621679076729"><a href="#local-6989586621679076729"><span class="hs-identifier">x</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679076729"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-130"></a><span>  </span><a name="local-8214565720323790790"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076730"><a href="#local-6989586621679076730"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076730"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-134"></a><span>  </span><a name="local-8214565720323790708"><span class="hs-identifier">toEnum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span>
</span><a name="line-135"></a><span>  </span><a name="local-8214565720323790707"><span class="hs-identifier">fromEnum</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a name="local-6989586621679076720"><a href="#local-6989586621679076720"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076720"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- | Nodes from within a graph.</span><span>
</span><a name="line-139"></a><span class="hs-keyword">data</span><span> </span><a name="Node"><a href="Graph.Graph.html#Node"><span class="hs-identifier">Node</span></a></a><span> </span><a name="local-6989586621679076465"><a href="#local-6989586621679076465"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-140"></a><span>  </span><a name="Node"><a href="Graph.Graph.html#Node"><span class="hs-identifier">Node</span></a></a><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="nodeId"><a href="Graph.Graph.html#nodeId"><span class="hs-identifier">nodeId</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-142"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="nodeInfo"><a href="Graph.Graph.html#nodeInfo"><span class="hs-identifier">nodeInfo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679076465"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Edges from within a graph.</span><span>
</span><a name="line-147"></a><span class="hs-keyword">data</span><span> </span><a name="Edge"><a href="Graph.Graph.html#Edge"><span class="hs-identifier">Edge</span></a></a><span> </span><a name="local-6989586621679076464"><a href="#local-6989586621679076464"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-148"></a><span>  </span><a name="Edge"><a href="Graph.Graph.html#Edge"><span class="hs-identifier">Edge</span></a></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="edgeId"><a href="Graph.Graph.html#edgeId"><span class="hs-identifier">edgeId</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="sourceId"><a href="Graph.Graph.html#sourceId"><span class="hs-identifier">sourceId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="targetId"><a href="Graph.Graph.html#targetId"><span class="hs-identifier">targetId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="edgeInfo"><a href="Graph.Graph.html#edgeInfo"><span class="hs-identifier">edgeInfo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679076464"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | A directed graph, allowing parallel edges. Both nodes and edges have optional payloads</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- of arbitrary types.</span><span>
</span><a name="line-158"></a><span class="hs-comment">--</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- Every node and edge is identified by a unique integer. The &quot;namespaces&quot; of nodes and edges are</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- independent, i.e. the same number may be used to identify both a node and an edge within the</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- same graph.</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- Equality tests cost /O(v&#178; + e&#178;)/, and disregards the payloads.</span><span>
</span><a name="line-164"></a><span class="hs-keyword">data</span><span> </span><a name="Graph"><a href="Graph.Graph.html#Graph"><span class="hs-identifier">Graph</span></a></a><span> </span><a name="local-6989586621679076462"><a href="#local-6989586621679076462"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076463"><a href="#local-6989586621679076463"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-165"></a><span>  </span><a name="Graph"><a href="Graph.Graph.html#Graph"><span class="hs-identifier">Graph</span></a></a><span>
</span><a name="line-166"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="nodeMap"><a href="Graph.Graph.html#nodeMap"><span class="hs-identifier">nodeMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679076462"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="edgeMap"><a href="Graph.Graph.html#edgeMap"><span class="hs-identifier">edgeMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span> </span><a href="#local-6989586621679076463"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | Verify equality of two lists ignoring order /O(m*n)/</span><span>
</span><a name="line-172"></a><span class="hs-identifier">eq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679076555"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679076555"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679076555"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-173"></a><a name="eq"><a href="Graph.Graph.html#eq"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621679076556"><a href="#local-6989586621679076556"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679076557"><a href="#local-6989586621679076557"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#contained"><span class="hs-identifier hs-var">contained</span></a><span> </span><a href="#local-6989586621679076556"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679076557"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Graph.Graph.html#contained"><span class="hs-identifier hs-var">contained</span></a><span> </span><a href="#local-6989586621679076557"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679076556"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- /O(m*n)/</span><span>
</span><a name="line-176"></a><span class="hs-identifier">contained</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679076554"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679076554"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679076554"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-177"></a><a name="contained"><a href="Graph.Graph.html#contained"><span class="hs-identifier">contained</span></a></a><span> </span><a name="local-6989586621679076558"><a href="#local-6989586621679076558"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679076559"><a href="#local-6989586621679076559"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">notElem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679076559"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076558"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076709"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076710"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076711"><a href="#local-6989586621679076711"><span class="hs-identifier">nodeMap1</span></a></a><span> </span><a name="local-6989586621679076712"><a href="#local-6989586621679076712"><span class="hs-identifier">edgeMap1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076713"><a href="#local-6989586621679076713"><span class="hs-identifier">nodeMap2</span></a></a><span> </span><a name="local-6989586621679076714"><a href="#local-6989586621679076714"><span class="hs-identifier">edgeMap2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-181"></a><span>      </span><span class="hs-keyword">let</span><span>
</span><a name="line-182"></a><span>        </span><a name="local-6989586621679076715"><a href="#local-6989586621679076715"><span class="hs-identifier">simplifyNode</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679076717"><a href="#local-6989586621679076717"><span class="hs-identifier">nodeId</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076717"><span class="hs-identifier hs-var">nodeId</span></a><span>
</span><a name="line-183"></a><span>        </span><a name="local-6989586621679076716"><a href="#local-6989586621679076716"><span class="hs-identifier">simplifyEdge</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679076718"><a href="#local-6989586621679076718"><span class="hs-identifier">edgeId</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679076719"><a href="#local-6989586621679076719"><span class="hs-identifier">edge</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076718"><span class="hs-identifier hs-var">edgeId</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sourceId</span><span> </span><a href="#local-6989586621679076719"><span class="hs-identifier hs-var">edge</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">targetId</span><span> </span><a href="#local-6989586621679076719"><span class="hs-identifier hs-var">edge</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>      </span><span class="hs-keyword">in</span><span>
</span><a name="line-185"></a><span>       </span><a href="Graph.Graph.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679076715"><span class="hs-identifier hs-var">simplifyNode</span></a><span> </span><a href="#local-6989586621679076711"><span class="hs-identifier hs-var">nodeMap1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679076715"><span class="hs-identifier hs-var">simplifyNode</span></a><span> </span><a href="#local-6989586621679076713"><span class="hs-identifier hs-var">nodeMap2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-186"></a><span>       </span><a href="Graph.Graph.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679076716"><span class="hs-identifier hs-var">simplifyEdge</span></a><span> </span><a href="#local-6989586621679076712"><span class="hs-identifier hs-var">edgeMap1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679076716"><span class="hs-identifier hs-var">simplifyEdge</span></a><span> </span><a href="#local-6989586621679076714"><span class="hs-identifier hs-var">edgeMap2</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076699"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076700"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-190"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076701"><a href="#local-6989586621679076701"><span class="hs-identifier">nodes</span></a></a><span> </span><a name="local-6989586621679076702"><a href="#local-6989586621679076702"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-191"></a><span>        </span><span class="hs-string">&quot;Nodes:\n&quot;</span><span>
</span><a name="line-192"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679076703"><span class="hs-identifier hs-var">showNode</span></a><span> </span><a href="#local-6989586621679076701"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-193"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Edges:\n&quot;</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679076704"><span class="hs-identifier hs-var">showEdge</span></a><span> </span><a href="#local-6989586621679076702"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-195"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-196"></a><span>        </span><a name="local-6989586621679076703"><a href="#local-6989586621679076703"><span class="hs-identifier">showNode</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679076705"><a href="#local-6989586621679076705"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-197"></a><span>          </span><span class="hs-string">&quot;\t&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076705"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span>        </span><a name="local-6989586621679076704"><a href="#local-6989586621679076704"><span class="hs-identifier">showEdge</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679076706"><a href="#local-6989586621679076706"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-var">Edge</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076707"><a href="#local-6989586621679076707"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679076708"><a href="#local-6989586621679076708"><span class="hs-identifier">tgt</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-200"></a><span>          </span><span class="hs-string">&quot;\t&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076706"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076707"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076708"><span class="hs-identifier hs-var">tgt</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-keyword">instance</span><span> </span><a href="Abstract.Cardinality.html#Cardinality"><span class="hs-identifier hs-type">Cardinality</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076697"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-205"></a><span>  </span><a name="local-8214565720323851167"><a href="Abstract.Cardinality.html#cardinality"><span class="hs-identifier">cardinality</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#cardinality%27"><span class="hs-identifier hs-var">cardinality'</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- * Contexts and graph traversal</span><span>
</span><a name="line-209"></a><span class="hs-comment">{- $contexts
In order to traverse or navigate through the graph, 'NodeContext's are provided. The context of a
node provides access to its incident edges and neighbour nodes without explicitly looking them up
in the graph. Internally, nodes and edges are still being looked up, so keep in mind there's no
performance benefit. This module, however, can guarantee that this implicit lookup will work, so
there's no need to deal with `Maybe` values.

As an example, depth-first search could be implemented as follows:

&gt;  depthFirstSearch :: NodeInContext n e -&gt; [Node n]
&gt;  depthFirstSearch initialNode =
&gt;      search IntSet.empty [initialNode]
&gt;
&gt;    where
&gt;      search _ [] = []
&gt;
&gt;      search visitedNodes ((node, context) : rest) =
&gt;        if node `IntSet.member` visitedNodes then
&gt;          search visitedNodes rest
&gt;
&gt;        else
&gt;          let
&gt;            nextNodes =
&gt;              [ target | (_, _, target) &lt;- outgoingEdges context ]
&gt;
&gt;          in
&gt;            node :: search (IntSet.insert (nodeId node) visitedNodes) nextNodes

-}</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-comment">-- | Provides access to a node's incident edges.</span><span>
</span><a name="line-240"></a><span class="hs-keyword">data</span><span> </span><a name="NodeContext"><a href="Graph.Graph.html#NodeContext"><span class="hs-identifier">NodeContext</span></a></a><span> </span><a name="local-6989586621679076460"><a href="#local-6989586621679076460"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076461"><a href="#local-6989586621679076461"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-241"></a><span>  </span><a name="NodeCtx"><a href="Graph.Graph.html#NodeCtx"><span class="hs-identifier">NodeCtx</span></a></a><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076460"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076461"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">-- | Shorthand for having a node along with its context.</span><span>
</span><a name="line-245"></a><span class="hs-keyword">type</span><span> </span><a name="NodeInContext"><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier">NodeInContext</span></a></a><span> </span><a name="local-6989586621679076458"><a href="#local-6989586621679076458"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076459"><a href="#local-6989586621679076459"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679076458"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeContext"><span class="hs-identifier hs-type">NodeContext</span></a><span> </span><a href="#local-6989586621679076458"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076459"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- | Shorthand for having an edge along with its source and target in context.</span><span>
</span><a name="line-250"></a><span class="hs-comment">--</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- Because of lazyness, constructing a value of this type does __not__ evaluate the node lookup.</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- Thus, forcing the evaluation of the nodes costs /O(v)/. Keep this in mind when using values</span><span>
</span><a name="line-253"></a><span class="hs-comment">-- of this type.</span><span>
</span><a name="line-254"></a><span class="hs-keyword">type</span><span> </span><a name="EdgeInContext"><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier">EdgeInContext</span></a></a><span> </span><a name="local-6989586621679076456"><a href="#local-6989586621679076456"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076457"><a href="#local-6989586621679076457"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier hs-type">NodeInContext</span></a><span> </span><a href="#local-6989586621679076456"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076457"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span> </span><a href="#local-6989586621679076457"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier hs-type">NodeInContext</span></a><span> </span><a href="#local-6989586621679076456"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076457"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-identifier">nodeInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076552"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076553"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679076552"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier hs-type">NodeInContext</span></a><span> </span><a href="#local-6989586621679076552"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076553"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-259"></a><a name="nodeInContext"><a href="Graph.Graph.html#nodeInContext"><span class="hs-identifier">nodeInContext</span></a></a><span> </span><a name="local-6989586621679076560"><a href="#local-6989586621679076560"><span class="hs-identifier">graph</span></a></a><span> </span><a name="local-6989586621679076561"><a href="#local-6989586621679076561"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679076561"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeCtx"><span class="hs-identifier hs-var">NodeCtx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeId</span><span> </span><a href="#local-6989586621679076561"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076560"><span class="hs-identifier hs-var">graph</span></a><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-identifier">edgeInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076550"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076551"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span> </span><a href="#local-6989586621679076551"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span> </span><a href="#local-6989586621679076550"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076551"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-264"></a><a name="edgeInContext"><a href="Graph.Graph.html#edgeInContext"><span class="hs-identifier">edgeInContext</span></a></a><span> </span><a name="local-6989586621679076562"><a href="#local-6989586621679076562"><span class="hs-identifier">graph</span></a></a><span> </span><a name="local-6989586621679076563"><a href="#local-6989586621679076563"><span class="hs-identifier">edge</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-keyword">let</span><span>
</span><a name="line-266"></a><span>    </span><a name="local-6989586621679076564"><a href="#local-6989586621679076564"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-267"></a><span>      </span><span class="hs-identifier">nodeMap</span><span> </span><a href="#local-6989586621679076562"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-268"></a><span>  </span><span class="hs-keyword">in</span><span>
</span><a name="line-269"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Graph.Graph.html#nodeInContext"><span class="hs-identifier hs-var">nodeInContext</span></a><span> </span><a href="#local-6989586621679076562"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sourceId</span><span> </span><a href="#local-6989586621679076563"><span class="hs-identifier hs-var">edge</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076564"><span class="hs-identifier hs-var">nodes</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679076563"><span class="hs-identifier hs-var">edge</span></a><span>
</span><a name="line-271"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#nodeInContext"><span class="hs-identifier hs-var">nodeInContext</span></a><span> </span><a href="#local-6989586621679076562"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">targetId</span><span> </span><a href="#local-6989586621679076563"><span class="hs-identifier hs-var">edge</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076564"><span class="hs-identifier hs-var">nodes</span></a><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- | Get the edges that are incident on the current node.</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- /O(e)/, plus the cost of evaluating the nodes of the result (see 'EdgeInContext').</span><span>
</span><a name="line-277"></a><span class="hs-identifier">incidentEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeContext"><span class="hs-identifier hs-type">NodeContext</span></a><span> </span><a href="#local-6989586621679076548"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076549"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span> </span><a href="#local-6989586621679076548"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076549"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-278"></a><a name="incidentEdges"><a href="Graph.Graph.html#incidentEdges"><span class="hs-identifier">incidentEdges</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeCtx"><span class="hs-identifier hs-var">NodeCtx</span></a><span> </span><a name="local-6989586621679076565"><a href="#local-6989586621679076565"><span class="hs-identifier">nodeId</span></a></a><span> </span><a name="local-6989586621679076566"><a href="#local-6989586621679076566"><span class="hs-identifier">graph</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeInContext"><span class="hs-identifier hs-var">edgeInContext</span></a><span> </span><a href="#local-6989586621679076566"><span class="hs-identifier hs-var">graph</span></a><span class="hs-special">)</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076567"><a href="#local-6989586621679076567"><span class="hs-identifier">edge</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">sourceId</span><span> </span><a href="#local-6989586621679076567"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679076565"><span class="hs-identifier hs-var">nodeId</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">targetId</span><span> </span><a href="#local-6989586621679076567"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679076565"><span class="hs-identifier hs-var">nodeId</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">edgeMap</span><span> </span><a href="#local-6989586621679076566"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">-- | Get the edges that have the current node as target.</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- /O(e)/, plus the cost of evaluating the nodes of the result (see 'EdgeInContext').</span><span>
</span><a name="line-287"></a><span class="hs-identifier">incomingEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeContext"><span class="hs-identifier hs-type">NodeContext</span></a><span> </span><a href="#local-6989586621679076546"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076547"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span> </span><a href="#local-6989586621679076546"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076547"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-288"></a><a name="incomingEdges"><a href="Graph.Graph.html#incomingEdges"><span class="hs-identifier">incomingEdges</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeCtx"><span class="hs-identifier hs-var">NodeCtx</span></a><span> </span><a name="local-6989586621679076568"><a href="#local-6989586621679076568"><span class="hs-identifier">nodeId</span></a></a><span> </span><a name="local-6989586621679076569"><a href="#local-6989586621679076569"><span class="hs-identifier">graph</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-289"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeInContext"><span class="hs-identifier hs-var">edgeInContext</span></a><span> </span><a href="#local-6989586621679076569"><span class="hs-identifier hs-var">graph</span></a><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076570"><a href="#local-6989586621679076570"><span class="hs-identifier">edge</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">targetId</span><span> </span><a href="#local-6989586621679076570"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679076568"><span class="hs-identifier hs-var">nodeId</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">edgeMap</span><span> </span><a href="#local-6989586621679076569"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-comment">-- | Get the edges that have the current node as source.</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- /O(e)/, plus the cost of evaluating the nodes of the result (see 'EdgeInContext').</span><span>
</span><a name="line-297"></a><span class="hs-identifier">outgoingEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeContext"><span class="hs-identifier hs-type">NodeContext</span></a><span> </span><a href="#local-6989586621679076544"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076545"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span> </span><a href="#local-6989586621679076544"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076545"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-298"></a><a name="outgoingEdges"><a href="Graph.Graph.html#outgoingEdges"><span class="hs-identifier">outgoingEdges</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeCtx"><span class="hs-identifier hs-var">NodeCtx</span></a><span> </span><a name="local-6989586621679076571"><a href="#local-6989586621679076571"><span class="hs-identifier">nodeId</span></a></a><span> </span><a name="local-6989586621679076572"><a href="#local-6989586621679076572"><span class="hs-identifier">graph</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-299"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeInContext"><span class="hs-identifier hs-var">edgeInContext</span></a><span> </span><a href="#local-6989586621679076572"><span class="hs-identifier hs-var">graph</span></a><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076573"><a href="#local-6989586621679076573"><span class="hs-identifier">edge</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">sourceId</span><span> </span><a href="#local-6989586621679076573"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679076571"><span class="hs-identifier hs-var">nodeId</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>
</span><a name="line-302"></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">edgeMap</span><span> </span><a href="#local-6989586621679076572"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">{- $neighbours

In order to access the neighbour nodes of the edges, one may simply go through the edges, e.g.

&gt;   map (\(_, _, target) -&gt; target) . outgoingEdges
&gt;   map (\(source, _, _) -&gt; source) . incomingEdges

These operations were not added to the graph API because it is not yet clear which of them are commonly used, and which names would be appropriate. If you identify the need for such an operation, submit an issue on github.
-}</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">-- | Infinite list of fresh node identifiers for a graph. /O(v)/.</span><span>
</span><a name="line-319"></a><span class="hs-identifier">newNodes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076542"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076543"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-320"></a><a name="newNodes"><a href="Graph.Graph.html#newNodes"><span class="hs-identifier">newNodes</span></a></a><span> </span><a name="local-6989586621679076574"><a href="#local-6989586621679076574"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679076575"><span class="hs-identifier hs-var">maxNode</span></a><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679076575"><a href="#local-6989586621679076575"><span class="hs-identifier">maxNode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#nodeIds"><span class="hs-identifier hs-var">nodeIds</span></a><span> </span><a href="#local-6989586621679076574"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-comment">-- | Infinite list of fresh edge identifiers for a graph. /O(e)/.</span><span>
</span><a name="line-324"></a><span class="hs-identifier">newEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076540"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076541"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-325"></a><a name="newEdges"><a href="Graph.Graph.html#newEdges"><span class="hs-identifier">newEdges</span></a></a><span> </span><a name="local-6989586621679076576"><a href="#local-6989586621679076576"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679076577"><span class="hs-identifier hs-var">maxEdge</span></a><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-326"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679076577"><a href="#local-6989586621679076577"><span class="hs-identifier">maxEdge</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier hs-var">edgeIds</span></a><span> </span><a href="#local-6989586621679076576"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- | Empty graph, with no nodes or edges. /O(1)/</span><span>
</span><a name="line-329"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076538"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076539"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-330"></a><a name="empty"><a href="Graph.Graph.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-comment">-- | Build a graph from lists of nodes and edges. Edges with undefined source or target are ignored</span><span>
</span><a name="line-333"></a><span class="hs-comment">-- and omitted from the resulting graph. /O(v + e*v)/</span><span>
</span><a name="line-334"></a><span class="hs-identifier">build</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679076536"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679076537"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><a name="build"><a href="Graph.Graph.html#build"><span class="hs-identifier">build</span></a></a><span> </span><a name="local-6989586621679076578"><a href="#local-6989586621679076578"><span class="hs-identifier">n</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679076580"><a href="#local-6989586621679076580"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679076581"><a href="#local-6989586621679076581"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679076582"><a href="#local-6989586621679076582"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#insertEdge"><span class="hs-identifier hs-var">insertEdge</span></a><span> </span><a href="#local-6989586621679076580"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679076581"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679076582"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679076583"><a href="#local-6989586621679076583"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679076584"><a href="#local-6989586621679076584"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679076585"><a href="#local-6989586621679076585"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-var">EdgeId</span></a><span> </span><a href="#local-6989586621679076583"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a href="#local-6989586621679076584"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span> </span><a href="#local-6989586621679076585"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076579"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-336"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-337"></a><span>        </span><a name="local-6989586621679076579"><a href="#local-6989586621679076579"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#insertNode"><span class="hs-identifier hs-var">insertNode</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a><span class="hs-special">)</span><span> </span><a href="Graph.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><a href="#local-6989586621679076578"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-comment">-- | Build a graph from lists of nodes and edges. Edges with undefined source or target are ignored</span><span>
</span><a name="line-341"></a><span class="hs-comment">-- and omitted from the resulting graph. /O(v + e*v)/</span><span>
</span><a name="line-342"></a><span class="hs-identifier">fromNodesAndEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679076534"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span> </span><a href="#local-6989586621679076535"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076534"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076535"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-343"></a><a name="fromNodesAndEdges"><a href="Graph.Graph.html#fromNodesAndEdges"><span class="hs-identifier">fromNodesAndEdges</span></a></a><span> </span><a name="local-6989586621679076586"><a href="#local-6989586621679076586"><span class="hs-identifier">nodes</span></a></a><span> </span><a name="local-6989586621679076587"><a href="#local-6989586621679076587"><span class="hs-identifier">edges</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-344"></a><span>  </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span>
</span><a name="line-345"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeId</span><span> </span><a href="#local-6989586621679076588"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679076588"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679076588"><a href="#local-6989586621679076588"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679076586"><span class="hs-identifier hs-var">nodes</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-346"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">edgeId</span><span> </span><a href="#local-6989586621679076589"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679076589"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679076589"><a href="#local-6989586621679076589"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679076587"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-348"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076590"><a href="#local-6989586621679076590"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">nodeId</span><span> </span><a href="#local-6989586621679076590"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">sourceId</span><span> </span><a href="#local-6989586621679076589"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076586"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-349"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076591"><a href="#local-6989586621679076591"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">nodeId</span><span> </span><a href="#local-6989586621679076591"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">targetId</span><span> </span><a href="#local-6989586621679076589"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076586"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-350"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-comment">-- | Insert a node with given identifier into a graph, without payload. If a node with the given</span><span>
</span><a name="line-353"></a><span class="hs-comment">-- identifier aready exists, its payload is removed. /O(v)/.</span><span>
</span><a name="line-354"></a><span class="hs-identifier">insertNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679076532"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076533"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679076532"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076533"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-355"></a><a name="insertNode"><a href="Graph.Graph.html#insertNode"><span class="hs-identifier">insertNode</span></a></a><span> </span><a name="local-6989586621679076592"><a href="#local-6989586621679076592"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076593"><a href="#local-6989586621679076593"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076594"><a href="#local-6989586621679076594"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-356"></a><span>    </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">addToAL</span><span> </span><a href="#local-6989586621679076593"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679076592"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><a href="#local-6989586621679076592"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076594"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-comment">-- | Insert a node with given identifier and payload into a graph. If a node with the given</span><span>
</span><a name="line-359"></a><span class="hs-comment">-- identifier already exists, its payload is updated. /O(v)/.</span><span>
</span><a name="line-360"></a><span class="hs-identifier">insertNodeWithPayload</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679076530"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076530"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076531"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076530"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076531"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-361"></a><a name="insertNodeWithPayload"><a href="Graph.Graph.html#insertNodeWithPayload"><span class="hs-identifier">insertNodeWithPayload</span></a></a><span> </span><a name="local-6989586621679076595"><a href="#local-6989586621679076595"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076596"><a href="#local-6989586621679076596"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076597"><a href="#local-6989586621679076597"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076598"><a href="#local-6989586621679076598"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-362"></a><span>    </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">addToAL</span><span> </span><a href="#local-6989586621679076597"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679076595"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><a href="#local-6989586621679076595"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679076596"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076598"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-comment">-- | (@insertEdge e src tgt g@) will insert an edge with identifier @e@ from @src@ to @tgt@ in graph</span><span>
</span><a name="line-365"></a><span class="hs-comment">-- @g@, without payload. If @src@ or @tgt@ are not nodes of @g@, the graph is not modified. If an</span><span>
</span><a name="line-366"></a><span class="hs-comment">-- edge with identifier @e@ already exists, it is updated. /O(v + e)/.</span><span>
</span><a name="line-367"></a><span class="hs-identifier">insertEdge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076528"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679076529"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076528"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679076529"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-368"></a><a name="insertEdge"><a href="Graph.Graph.html#insertEdge"><span class="hs-identifier">insertEdge</span></a></a><span> </span><a name="local-6989586621679076599"><a href="#local-6989586621679076599"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679076600"><a href="#local-6989586621679076600"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679076601"><a href="#local-6989586621679076601"><span class="hs-identifier">tgt</span></a></a><span> </span><a name="local-6989586621679076602"><a href="#local-6989586621679076602"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076603"><a href="#local-6989586621679076603"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076604"><a href="#local-6989586621679076604"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679076600"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">keysAL</span><span> </span><a href="#local-6989586621679076603"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679076601"><span class="hs-identifier hs-var">tgt</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">keysAL</span><span> </span><a href="#local-6989586621679076603"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-370"></a><span>        </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a href="#local-6989586621679076603"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">addToAL</span><span> </span><a href="#local-6989586621679076604"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679076599"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-var">Edge</span></a><span> </span><a href="#local-6989586621679076599"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679076600"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679076601"><span class="hs-identifier hs-var">tgt</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076602"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- | (@insertEdgeWithPayload e src tgt p g@) will insert an edge with identifier @e@ from @src@ to</span><span>
</span><a name="line-374"></a><span class="hs-comment">-- @tgt@ in graph @g@ with payload @p@. If @src@ or @tgt@ are not nodes of @g@, the graph is not</span><span>
</span><a name="line-375"></a><span class="hs-comment">-- modified. If an edge with identifier @e@ already exists, it is updated. /O(v + e)/.</span><span>
</span><a name="line-376"></a><span class="hs-identifier">insertEdgeWithPayload</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679076526"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076527"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076526"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076527"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076526"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-377"></a><a name="insertEdgeWithPayload"><a href="Graph.Graph.html#insertEdgeWithPayload"><span class="hs-identifier">insertEdgeWithPayload</span></a></a><span> </span><a name="local-6989586621679076605"><a href="#local-6989586621679076605"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679076606"><a href="#local-6989586621679076606"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679076607"><a href="#local-6989586621679076607"><span class="hs-identifier">tgt</span></a></a><span> </span><a name="local-6989586621679076608"><a href="#local-6989586621679076608"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679076609"><a href="#local-6989586621679076609"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076610"><a href="#local-6989586621679076610"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076611"><a href="#local-6989586621679076611"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679076606"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">keysAL</span><span> </span><a href="#local-6989586621679076610"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679076607"><span class="hs-identifier hs-var">tgt</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">keysAL</span><span> </span><a href="#local-6989586621679076610"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-379"></a><span>        </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a href="#local-6989586621679076610"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">addToAL</span><span> </span><a href="#local-6989586621679076611"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679076605"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-var">Edge</span></a><span> </span><a href="#local-6989586621679076605"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679076606"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679076607"><span class="hs-identifier hs-var">tgt</span></a><span> </span><a href="#local-6989586621679076608"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076609"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-comment">-- | Removes the given node from the graph, unless it has any incident edges. /O(v + e&#178;)/.</span><span>
</span><a name="line-383"></a><span class="hs-identifier">removeNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076524"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076525"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076524"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076525"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-384"></a><a name="removeNode"><a href="Graph.Graph.html#removeNode"><span class="hs-identifier">removeNode</span></a></a><span> </span><a name="local-6989586621679076612"><a href="#local-6989586621679076612"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076613"><a href="#local-6989586621679076613"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076614"><a href="#local-6989586621679076614"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076615"><a href="#local-6989586621679076615"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.Graph.html#getIncidentEdges"><span class="hs-identifier hs-var">getIncidentEdges</span></a><span> </span><a href="#local-6989586621679076613"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076612"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">delFromAL</span><span> </span><a href="#local-6989586621679076614"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679076612"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076615"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-386"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076613"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">-- | Removes the given node from the graph, unless it has any incident edges. /O(v + e&#178;)/.</span><span>
</span><a name="line-389"></a><span class="hs-comment">-- It does not verify if the node has incident edges, thus it may generate invalid graphs.</span><span>
</span><a name="line-390"></a><span class="hs-identifier">removeNodeForced</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076522"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076523"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076522"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076523"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-391"></a><a name="removeNodeForced"><a href="Graph.Graph.html#removeNodeForced"><span class="hs-identifier">removeNodeForced</span></a></a><span> </span><a name="local-6989586621679076616"><a href="#local-6989586621679076616"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076617"><a href="#local-6989586621679076617"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076618"><a href="#local-6989586621679076618"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">delFromAL</span><span> </span><a href="#local-6989586621679076617"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679076616"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076618"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-comment">-- | Removes the given node and all incident edges from the graph. /O(v + e)/</span><span>
</span><a name="line-394"></a><span class="hs-identifier">removeNodeAndIncidentEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076520"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076521"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076520"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076521"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-395"></a><a name="removeNodeAndIncidentEdges"><a href="Graph.Graph.html#removeNodeAndIncidentEdges"><span class="hs-identifier">removeNodeAndIncidentEdges</span></a></a><span> </span><a name="local-6989586621679076619"><a href="#local-6989586621679076619"><span class="hs-identifier">nodeId</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076620"><a href="#local-6989586621679076620"><span class="hs-identifier">nodes</span></a></a><span> </span><a name="local-6989586621679076621"><a href="#local-6989586621679076621"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-396"></a><span>  </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span>
</span><a name="line-397"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">delFromAL</span><span> </span><a href="#local-6989586621679076620"><span class="hs-identifier hs-var">nodes</span></a><span> </span><a href="#local-6989586621679076619"><span class="hs-identifier hs-var">nodeId</span></a><span class="hs-special">)</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679076622"><a href="#local-6989586621679076622"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">sourceId</span><span> </span><a href="#local-6989586621679076622"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679076619"><span class="hs-identifier hs-var">nodeId</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier">targetId</span><span> </span><a href="#local-6989586621679076622"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679076619"><span class="hs-identifier hs-var">nodeId</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076621"><span class="hs-identifier hs-var">edges</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-comment">-- | Remove the given edge from the graph. /O(e)/.</span><span>
</span><a name="line-401"></a><span class="hs-identifier">removeEdge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076518"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076519"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076518"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076519"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-402"></a><a name="removeEdge"><a href="Graph.Graph.html#removeEdge"><span class="hs-identifier">removeEdge</span></a></a><span> </span><a name="local-6989586621679076623"><a href="#local-6989586621679076623"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076624"><a href="#local-6989586621679076624"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679076625"><a href="#local-6989586621679076625"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a href="#local-6989586621679076624"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">delFromAL</span><span> </span><a href="#local-6989586621679076625"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679076623"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span class="hs-comment">-- | Update the node's payload, applying the given function on it. /O(v)/.</span><span>
</span><a name="line-405"></a><span class="hs-identifier">updateNodePayload</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076516"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076517"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076516"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679076516"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076516"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076517"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-406"></a><a name="updateNodePayload"><a href="Graph.Graph.html#updateNodePayload"><span class="hs-identifier">updateNodePayload</span></a></a><span> </span><a name="local-6989586621679076626"><a href="#local-6989586621679076626"><span class="hs-identifier">nodeId</span></a></a><span> </span><a name="local-6989586621679076627"><a href="#local-6989586621679076627"><span class="hs-identifier">graph</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076628"><a href="#local-6989586621679076628"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679076629"><a href="#local-6989586621679076629"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-407"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679076626"><span class="hs-identifier hs-var">nodeId</span></a><span> </span><a href="#local-6989586621679076628"><span class="hs-identifier hs-var">nodes</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-409"></a><span>      </span><a href="#local-6989586621679076627"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679076630"><a href="#local-6989586621679076630"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-412"></a><span>      </span><span class="hs-keyword">let</span><span>
</span><a name="line-413"></a><span>        </span><a name="local-6989586621679076631"><a href="#local-6989586621679076631"><span class="hs-identifier">updatedNode</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-414"></a><span>          </span><a href="#local-6989586621679076630"><span class="hs-identifier hs-var">node</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nodeInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076629"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeInfo</span><span> </span><a href="#local-6989586621679076630"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-415"></a><span>      </span><span class="hs-keyword">in</span><span>
</span><a name="line-416"></a><span>        </span><a href="#local-6989586621679076627"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nodeMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">addToAL</span><span> </span><a href="#local-6989586621679076628"><span class="hs-identifier hs-var">nodes</span></a><span> </span><a href="#local-6989586621679076626"><span class="hs-identifier hs-var">nodeId</span></a><span> </span><a href="#local-6989586621679076631"><span class="hs-identifier hs-var">updatedNode</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">-- | Update the edge's payload, applying the function on it. /O(e)/.</span><span>
</span><a name="line-420"></a><span class="hs-identifier">updateEdgePayload</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076514"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076515"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076515"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679076515"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076514"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076515"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-421"></a><a name="updateEdgePayload"><a href="Graph.Graph.html#updateEdgePayload"><span class="hs-identifier">updateEdgePayload</span></a></a><span> </span><a name="local-6989586621679076632"><a href="#local-6989586621679076632"><span class="hs-identifier">edgeId</span></a></a><span> </span><a name="local-6989586621679076633"><a href="#local-6989586621679076633"><span class="hs-identifier">graph</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076634"><a href="#local-6989586621679076634"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679076635"><a href="#local-6989586621679076635"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-422"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679076632"><span class="hs-identifier hs-var">edgeId</span></a><span> </span><a href="#local-6989586621679076634"><span class="hs-identifier hs-var">edges</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-423"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-424"></a><span>      </span><a href="#local-6989586621679076633"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679076636"><a href="#local-6989586621679076636"><span class="hs-identifier">edge</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-427"></a><span>      </span><span class="hs-keyword">let</span><span>
</span><a name="line-428"></a><span>        </span><a name="local-6989586621679076637"><a href="#local-6989586621679076637"><span class="hs-identifier">updatedEdge</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-429"></a><span>          </span><a href="#local-6989586621679076636"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">edgeInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076635"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">edgeInfo</span><span> </span><a href="#local-6989586621679076636"><span class="hs-identifier hs-var">edge</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span>      </span><span class="hs-keyword">in</span><span>
</span><a name="line-432"></a><span>        </span><a href="#local-6989586621679076633"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">edgeMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">addToAL</span><span> </span><a href="#local-6989586621679076634"><span class="hs-identifier hs-var">edges</span></a><span> </span><a href="#local-6989586621679076632"><span class="hs-identifier hs-var">edgeId</span></a><span> </span><a href="#local-6989586621679076637"><span class="hs-identifier hs-var">updatedEdge</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-comment">-- | List of all node id's from from the graph. /O(v)/.</span><span>
</span><a name="line-436"></a><span class="hs-identifier">nodeIds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076512"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076513"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-437"></a><a name="nodeIds"><a href="Graph.Graph.html#nodeIds"><span class="hs-identifier">nodeIds</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076638"><a href="#local-6989586621679076638"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">keysAL</span><span> </span><a href="#local-6989586621679076638"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-comment">-- | List of all edge id's from from the graph. /O(e)/.</span><span>
</span><a name="line-441"></a><span class="hs-identifier">edgeIds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076510"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076511"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-442"></a><a name="edgeIds"><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier">edgeIds</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076639"><a href="#local-6989586621679076639"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">keysAL</span><span> </span><a href="#local-6989586621679076639"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span>
</span><a name="line-445"></a><span class="hs-comment">-- | List of all nodes from the graph. /O(v)/.</span><span>
</span><a name="line-446"></a><span class="hs-identifier">nodes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076509"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679076508"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-447"></a><a name="nodes"><a href="Graph.Graph.html#nodes"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076640"><a href="#local-6989586621679076640"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679076640"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-448"></a><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-comment">-- | List of all edges from the graph. /O(e)/.</span><span>
</span><a name="line-451"></a><span class="hs-identifier">edges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076506"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076507"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span> </span><a href="#local-6989586621679076507"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-452"></a><a name="edges"><a href="Graph.Graph.html#edges"><span class="hs-identifier">edges</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076641"><a href="#local-6989586621679076641"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679076641"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-comment">-- | List of all nodes from the graph, along with their contexts. /O(v)/.</span><span>
</span><a name="line-456"></a><span class="hs-identifier">nodesInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076505"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier hs-type">NodeInContext</span></a><span> </span><a href="#local-6989586621679076504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076505"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-457"></a><a name="nodesInContext"><a href="Graph.Graph.html#nodesInContext"><span class="hs-identifier">nodesInContext</span></a></a><span> </span><a name="local-6989586621679076642"><a href="#local-6989586621679076642"><span class="hs-identifier">graph</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076643"><a href="#local-6989586621679076643"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-458"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#nodeInContext"><span class="hs-identifier hs-var">nodeInContext</span></a><span> </span><a href="#local-6989586621679076642"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076643"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-comment">-- | List of all edges from the graph, along with their contexts.</span><span>
</span><a name="line-462"></a><span class="hs-comment">-- /O(e)/, plus the cost of evaluating the nodes of the result (see 'EdgeInContext').</span><span>
</span><a name="line-463"></a><span class="hs-identifier">edgesInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076503"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span> </span><a href="#local-6989586621679076502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076503"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-464"></a><a name="edgesInContext"><a href="Graph.Graph.html#edgesInContext"><span class="hs-identifier">edgesInContext</span></a></a><span> </span><a name="local-6989586621679076644"><a href="#local-6989586621679076644"><span class="hs-identifier">graph</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076645"><a href="#local-6989586621679076645"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-465"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeInContext"><span class="hs-identifier hs-var">edgeInContext</span></a><span> </span><a href="#local-6989586621679076644"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679076645"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span class="hs-pragma">{-# DEPRECATED nodesOf, sourceOf, sourceOfUnsafe, targetOf, targetOfUnsafe, getIncidentEdges &quot;This function performs unnecessary dictionary lookups. Try using lookupNode, lookupNodeInContext, nodes or nodesInContext instead.&quot; #-}</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-comment">-- | Look up the node with given identifier in the graph. /O(v)/.</span><span>
</span><a name="line-472"></a><span class="hs-identifier">lookupNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076500"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076501"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679076500"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-473"></a><a name="lookupNode"><a href="Graph.Graph.html#lookupNode"><span class="hs-identifier">lookupNode</span></a></a><span> </span><a name="local-6989586621679076646"><a href="#local-6989586621679076646"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><a name="local-6989586621679076647"><a href="#local-6989586621679076647"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-474"></a><span>  </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679076646"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679076647"><span class="hs-identifier hs-var">nodes</span></a><span>
</span><a name="line-475"></a><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-comment">-- | Look up the edge with given identifier in the graph. /O(e)/.</span><span>
</span><a name="line-478"></a><span class="hs-identifier">lookupEdge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076498"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076499"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a><span> </span><a href="#local-6989586621679076499"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><a name="lookupEdge"><a href="Graph.Graph.html#lookupEdge"><span class="hs-identifier">lookupEdge</span></a></a><span> </span><a name="local-6989586621679076648"><a href="#local-6989586621679076648"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076649"><a href="#local-6989586621679076649"><span class="hs-identifier">edges</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-480"></a><span>  </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679076648"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679076649"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-comment">-- | Look up the node with given identifier, along with its context, in the graph. /O(v)/.</span><span>
</span><a name="line-484"></a><span class="hs-identifier">lookupNodeInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076497"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeInContext"><span class="hs-identifier hs-type">NodeInContext</span></a><span> </span><a href="#local-6989586621679076496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076497"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-485"></a><a name="lookupNodeInContext"><a href="Graph.Graph.html#lookupNodeInContext"><span class="hs-identifier">lookupNodeInContext</span></a></a><span> </span><a name="local-6989586621679076650"><a href="#local-6989586621679076650"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679076651"><a href="#local-6989586621679076651"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-486"></a><span>  </span><a href="Graph.Graph.html#nodeInContext"><span class="hs-identifier hs-var">nodeInContext</span></a><span> </span><a href="#local-6989586621679076651"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Graph.Graph.html#lookupNode"><span class="hs-identifier hs-var">lookupNode</span></a><span> </span><a href="#local-6989586621679076650"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679076651"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-comment">-- | Look up the edge with given identifier, along with its context, in the graph.</span><span>
</span><a name="line-490"></a><span class="hs-comment">-- /O(e)/, plus the cost of evaluating the nodes of the result (see 'EdgeInContext').</span><span>
</span><a name="line-491"></a><span class="hs-identifier">lookupEdgeInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076495"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#EdgeInContext"><span class="hs-identifier hs-type">EdgeInContext</span></a><span> </span><a href="#local-6989586621679076494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076495"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-492"></a><a name="lookupEdgeInContext"><a href="Graph.Graph.html#lookupEdgeInContext"><span class="hs-identifier">lookupEdgeInContext</span></a></a><span> </span><a name="local-6989586621679076652"><a href="#local-6989586621679076652"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679076653"><a href="#local-6989586621679076653"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-493"></a><span>  </span><a href="Graph.Graph.html#edgeInContext"><span class="hs-identifier hs-var">edgeInContext</span></a><span> </span><a href="#local-6989586621679076653"><span class="hs-identifier hs-var">graph</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Graph.Graph.html#lookupEdge"><span class="hs-identifier hs-var">lookupEdge</span></a><span> </span><a href="#local-6989586621679076652"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679076653"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-comment">-- | Gets a pair containing the source and target of the given edge. /O(e)/.</span><span>
</span><a name="line-497"></a><span class="hs-identifier">nodesOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076492"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076493"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><a name="nodesOf"><a href="Graph.Graph.html#nodesOf"><span class="hs-identifier">nodesOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076654"><a href="#local-6989586621679076654"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679076655"><a href="#local-6989586621679076655"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-499"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679076656"><a href="#local-6989586621679076656"><span class="hs-identifier">ed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679076655"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679076654"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-500"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679076656"><span class="hs-identifier hs-var">ed</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-501"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-var">Edge</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076657"><a href="#local-6989586621679076657"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679076658"><a href="#local-6989586621679076658"><span class="hs-identifier">tgt</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076657"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679076658"><span class="hs-identifier hs-var">tgt</span></a><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>        </span><span class="hs-identifier">_</span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span class="hs-comment">-- | Gets the source of the given edge. /O(e)/.</span><span>
</span><a name="line-506"></a><span class="hs-identifier">sourceOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076490"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076491"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-507"></a><a name="sourceOf"><a href="Graph.Graph.html#sourceOf"><span class="hs-identifier">sourceOf</span></a></a><span> </span><a name="local-6989586621679076659"><a href="#local-6989586621679076659"><span class="hs-identifier">graph</span></a></a><span> </span><a name="local-6989586621679076660"><a href="#local-6989586621679076660"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-508"></a><span>  </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Graph.Graph.html#nodesOf"><span class="hs-identifier hs-var">nodesOf</span></a><span> </span><a href="#local-6989586621679076659"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-6989586621679076660"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span class="hs-comment">-- | Gets the target of the given edge. /O(e)/.</span><span>
</span><a name="line-512"></a><span class="hs-identifier">targetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076488"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076489"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-513"></a><a name="targetOf"><a href="Graph.Graph.html#targetOf"><span class="hs-identifier">targetOf</span></a></a><span> </span><a name="local-6989586621679076661"><a href="#local-6989586621679076661"><span class="hs-identifier">graph</span></a></a><span> </span><a name="local-6989586621679076662"><a href="#local-6989586621679076662"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-514"></a><span>  </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Graph.Graph.html#nodesOf"><span class="hs-identifier hs-var">nodesOf</span></a><span> </span><a href="#local-6989586621679076661"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-6989586621679076662"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span class="hs-comment">-- | Gets the source of the given edge, crashing if no such edge exists. /O(e)/.</span><span>
</span><a name="line-518"></a><span class="hs-identifier">sourceOfUnsafe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076486"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076487"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-519"></a><a name="sourceOfUnsafe"><a href="Graph.Graph.html#sourceOfUnsafe"><span class="hs-identifier">sourceOfUnsafe</span></a></a><span> </span><a name="local-6989586621679076663"><a href="#local-6989586621679076663"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076664"><a href="#local-6989586621679076664"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error, graph with source edges function non total&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.Graph.html#sourceOf"><span class="hs-identifier hs-var">sourceOf</span></a><span> </span><a href="#local-6989586621679076663"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076664"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-comment">-- | Gets the target of the given edge, crashing if no such edge exists. /O(e)/.</span><span>
</span><a name="line-522"></a><span class="hs-identifier">targetOfUnsafe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076484"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076485"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span>
</span><a name="line-523"></a><a name="targetOfUnsafe"><a href="Graph.Graph.html#targetOfUnsafe"><span class="hs-identifier">targetOfUnsafe</span></a></a><span> </span><a name="local-6989586621679076665"><a href="#local-6989586621679076665"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076666"><a href="#local-6989586621679076666"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error, graph with target edges function non total&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.Graph.html#targetOf"><span class="hs-identifier hs-var">targetOf</span></a><span> </span><a href="#local-6989586621679076665"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076666"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-comment">-- | Test whether a graph is empty. /O(1)/.</span><span>
</span><a name="line-527"></a><span class="hs-identifier">null</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076482"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076483"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-528"></a><a name="null"><a href="Graph.Graph.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-529"></a><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-530"></a><span>
</span><a name="line-531"></a><span class="hs-comment">-- | Given a graph, it returns the number of vertices plus the number of edges</span><span>
</span><a name="line-532"></a><span class="hs-identifier">cardinality'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076480"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076481"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-533"></a><a name="cardinality%27"><a href="Graph.Graph.html#cardinality%27"><span class="hs-identifier">cardinality'</span></a></a><span> </span><a name="local-6989586621679076667"><a href="#local-6989586621679076667"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#nodes"><span class="hs-identifier hs-var">nodes</span></a><span> </span><a href="#local-6989586621679076667"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edges"><span class="hs-identifier hs-var">edges</span></a><span> </span><a href="#local-6989586621679076667"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-comment">-- | Test if a node identifier is contained in the graph. /O(v)/.</span><span>
</span><a name="line-536"></a><span class="hs-identifier">isNodeOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076478"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076479"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-537"></a><a name="isNodeOf"><a href="Graph.Graph.html#isNodeOf"><span class="hs-identifier">isNodeOf</span></a></a><span> </span><a name="local-6989586621679076668"><a href="#local-6989586621679076668"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076669"><a href="#local-6989586621679076669"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076669"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Graph.Graph.html#nodeIds"><span class="hs-identifier hs-var">nodeIds</span></a><span> </span><a href="#local-6989586621679076668"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-comment">-- | Test if an edge identifier is contained in the graph. /O(e)/.</span><span>
</span><a name="line-540"></a><span class="hs-identifier">isEdgeOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076476"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076477"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-541"></a><a name="isEdgeOf"><a href="Graph.Graph.html#isEdgeOf"><span class="hs-identifier">isEdgeOf</span></a></a><span> </span><a name="local-6989586621679076670"><a href="#local-6989586621679076670"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076671"><a href="#local-6989586621679076671"><span class="hs-identifier">e</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679076671"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier hs-var">edgeIds</span></a><span> </span><a href="#local-6989586621679076670"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span class="hs-comment">-- | Test if the given nodes are adjacent. /O(e&#178;)/</span><span>
</span><a name="line-544"></a><span class="hs-identifier">isAdjacentTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076474"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076475"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-545"></a><a name="isAdjacentTo"><a href="Graph.Graph.html#isAdjacentTo"><span class="hs-identifier">isAdjacentTo</span></a></a><span> </span><a name="local-6989586621679076672"><a href="#local-6989586621679076672"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076673"><a href="#local-6989586621679076673"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679076674"><a href="#local-6989586621679076674"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-546"></a><span>    </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076675"><a href="#local-6989586621679076675"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#nodesOf"><span class="hs-identifier hs-var">nodesOf</span></a><span> </span><a href="#local-6989586621679076672"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076675"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076673"><span class="hs-identifier hs-var">n1</span></a><span class="hs-special">,</span><a href="#local-6989586621679076674"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier hs-var">edgeIds</span></a><span> </span><a href="#local-6989586621679076672"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">-- | Test if the given edge has given node as source or target. /O(e)/.</span><span>
</span><a name="line-549"></a><span class="hs-identifier">isIncidentTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076472"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076473"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-550"></a><a name="isIncidentTo"><a href="Graph.Graph.html#isIncidentTo"><span class="hs-identifier">isIncidentTo</span></a></a><span> </span><a name="local-6989586621679076676"><a href="#local-6989586621679076676"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076677"><a href="#local-6989586621679076677"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679076678"><a href="#local-6989586621679076678"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-551"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679076679"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-552"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679076680"><a href="#local-6989586621679076680"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679076681"><a href="#local-6989586621679076681"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679076677"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679076680"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679076677"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679076681"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-553"></a><span>        </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-554"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-555"></a><span>    </span><a name="local-6989586621679076679"><a href="#local-6989586621679076679"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graph.Graph.html#nodesOf"><span class="hs-identifier hs-var">nodesOf</span></a><span> </span><a href="#local-6989586621679076676"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076678"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">-- | Gets a list of all edges incident to the given node. /O(e&#178;)/</span><span>
</span><a name="line-558"></a><span class="hs-identifier">getIncidentEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076470"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076471"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-559"></a><a name="getIncidentEdges"><a href="Graph.Graph.html#getIncidentEdges"><span class="hs-identifier">getIncidentEdges</span></a></a><span> </span><a name="local-6989586621679076682"><a href="#local-6989586621679076682"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076683"><a href="#local-6989586621679076683"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nub</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graph.Graph.html#getIncomingEdges"><span class="hs-identifier hs-var">getIncomingEdges</span></a><span> </span><a href="#local-6989586621679076682"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076683"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Graph.Graph.html#getOutgoingEdges"><span class="hs-identifier hs-var">getOutgoingEdges</span></a><span> </span><a href="#local-6989586621679076682"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076683"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-560"></a><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">-- | Gets a list of all edges whose source is the given node. /O(e&#178;)/.</span><span>
</span><a name="line-563"></a><span class="hs-identifier">getOutgoingEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076468"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076469"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-564"></a><a name="getOutgoingEdges"><a href="Graph.Graph.html#getOutgoingEdges"><span class="hs-identifier">getOutgoingEdges</span></a></a><span> </span><a name="local-6989586621679076684"><a href="#local-6989586621679076684"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076685"><a href="#local-6989586621679076685"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076686"><a href="#local-6989586621679076686"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#sourceOf"><span class="hs-identifier hs-var">sourceOf</span></a><span> </span><a href="#local-6989586621679076684"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076686"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679076685"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier hs-var">edgeIds</span></a><span> </span><a href="#local-6989586621679076684"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-comment">-- | Gets a list of all edges whose target is the given node. /O(e&#178;)/.</span><span>
</span><a name="line-568"></a><span class="hs-identifier">getIncomingEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076466"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076467"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graph.Graph.html#EdgeId"><span class="hs-identifier hs-type">EdgeId</span></a><span class="hs-special">]</span><span>
</span><a name="line-569"></a><a name="getIncomingEdges"><a href="Graph.Graph.html#getIncomingEdges"><span class="hs-identifier">getIncomingEdges</span></a></a><span> </span><a name="local-6989586621679076687"><a href="#local-6989586621679076687"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679076688"><a href="#local-6989586621679076688"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679076689"><a href="#local-6989586621679076689"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graph.Graph.html#targetOf"><span class="hs-identifier hs-var">targetOf</span></a><span> </span><a href="#local-6989586621679076687"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679076689"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679076688"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#edgeIds"><span class="hs-identifier hs-var">edgeIds</span></a><span> </span><a href="#local-6989586621679076687"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-keyword">instance</span><span> </span><a href="Abstract.Valid.html#Valid"><span class="hs-identifier hs-type">Valid</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-6989586621679076690"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679076691"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-573"></a><span>    </span><a name="local-8214565720323847579"><a href="Abstract.Valid.html#validate"><span class="hs-identifier">validate</span></a></a><span> </span><a name="local-6989586621679076692"><a href="#local-6989586621679076692"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-574"></a><span>      </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679076693"><span class="hs-identifier hs-var">validateEdge</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">edgeMap</span><span> </span><a href="#local-6989586621679076692"><span class="hs-identifier hs-var">graph</span></a><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-576"></a><span>        </span><a name="local-6989586621679076693"><a href="#local-6989586621679076693"><span class="hs-identifier">validateEdge</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679076694"><a href="#local-6989586621679076694"><span class="hs-identifier">edge</span></a></a><span class="hs-special">,</span><span> </span><a href="Graph.Graph.html#Edge"><span class="hs-identifier hs-var">Edge</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679076695"><a href="#local-6989586621679076695"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679076696"><a href="#local-6989586621679076696"><span class="hs-identifier">tgt</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-577"></a><span>          </span><span class="hs-identifier hs-var">mconcat</span><span>
</span><a name="line-578"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="Abstract.Valid.html#ensure"><span class="hs-identifier hs-var">ensure</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#isNodeOf"><span class="hs-identifier hs-var">isNodeOf</span></a><span> </span><a href="#local-6989586621679076692"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-6989586621679076695"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Source node #&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076695"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; of edge #&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076694"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; is not a member of the graph&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Abstract.Valid.html#ensure"><span class="hs-identifier hs-var">ensure</span></a><span> </span><span class="hs-special">(</span><a href="Graph.Graph.html#isNodeOf"><span class="hs-identifier hs-var">isNodeOf</span></a><span> </span><a href="#local-6989586621679076692"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-6989586621679076696"><span class="hs-identifier hs-var">tgt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Target node #&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076695"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; of edge #&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679076694"><span class="hs-identifier hs-var">edge</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; is not a member of the graph&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-581"></a></pre></body></html>